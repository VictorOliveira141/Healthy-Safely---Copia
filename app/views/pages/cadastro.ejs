<html>
    <head>
        <title>Cadastro</title>
        <link rel="stylesheet" href="../css/cadastro.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    </head>

    <body>
    <!--Validação(cadastro)-->
    <%
    let erroValidacao =  {
        "nome": "", 
        "email": "",
        "senha": "",
        "confirmar-senha": ""
    };
    let msgErro =  {
        "nome": "", 
        "email": "",
        "senha": "",
        "confirmar-senha": ""
    };
    if (erros) {
        erros.errors.forEach(function(erro) {
            if (erro.path == "nome") {
                erroValidacao.nome = "erro";
                msgErro.nome = erro.msg;
            }
            if (erro.path == "email") {
                erroValidacao.email = "erro";
                msgErro.email = erro.msg;
            }
            if (erro.path == "senha") {
                erroValidacao.senha = "erro";
                msgErro.senha = erro.msg;
            }
            if (erro.path == "confirmar-senha") {
                erroValidacao["confirmar-senha"] = "erro";
                msgErro["confirmar-senha"] = erro.msg;
            }
        });
    }
    %>
    <!--Fim da Validação(cadastro)-->

    <form action="/cadastro" method="POST" class="quadrado" enctype="multipart/form-data">
    <h1>Cadastro</h1>

    <article class="file-container">
        <label for="file-upload" class="fotodeperfil">
            <i id="icon" class="bi bi-person-circle"></i>
            <img id="profile-preview" src="" alt="Pré-visualização" style="display: none;">
        </label>
        <input type="file" id="file-upload" name="foto" accept="image/*" onchange="previewAndUploadImage(event)">
    </article>

    <!--JS para Upload de Imagem-->
    <script>
    function previewAndUploadImage(event) {
        const input = event.target;
        const reader = new FileReader();

        reader.onload = function () {
            const dataURL = reader.result;
            const output = document.getElementById("profile-preview");
            output.src = dataURL;
            output.style.display = "block";

            document.getElementById("icon").style.display = "none";
        };
        reader.readAsDataURL(input.files[0]);
    }
    </script>
    <!--Fim do JS para Upload de Imagem-->

    <br>
    <article>
        <label for="nome">Digite seu nome completo:</label>
        <input type="text" id="nome" name="nome" value="<%= valores.nome %>" class="<%= erroValidacao.nome %>">
        <span class="msgErro"><%= msgErro.nome %></span>
    </article>

    <br>
    <article>    
        <label for="email">Adicione um Endereço de email:</label>
        <input type="text" id="email" name="email" placeholder="example123@gmail.com" value="<%= valores.email %>" class="<%= erroValidacao.email %>">
        <span class="msgErro"><%= msgErro.email %></span>
    </article>

    <br>
    <article>
        <label for="dob">Data de Nascimento:</label>
        <input type="date" id="dob" name="dob">
    </article>

    <br>
    <article>
        <label for="senha">Crie uma senha:</label>
        <input type="password" id="senha" name="senha" value="<%= valores.senha %>" class="<%= erroValidacao.senha %>">
        <span class="msgErro"><%= msgErro.senha %></span>
    </article>

    <br>
    <article>
        <label for="confirmar-senha">Confirmar senha:</label>
        <input type="password" id="confirmar-senha" name="confirmar-senha" value="<%= valores["confirmar-senha"] %>" class="<%= erroValidacao["confirmar-senha"] %>">
        <span class="msgErro"><%= msgErro["confirmar-senha"] %></span>
    </article>

    <h4 class="login">Já possui uma conta? Faça seu <a href="/login">login</a></h4>

    <button type="submit" id="btnClique">Juntar-se</button>
    </form>
</body>
</html>
<link rel="stylesheet" href="/css/header.css" />

<header class="header">
  <section class="header-container">
    <!-- MENU HAMBURGUER ESCONDIDO (aparece a partir de 650px) -->
    <section class="menu-toggle-wrapper">
      <input type="checkbox" id="menuToggle" />
      <label for="menuToggle" class="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </label>

      <nav id="menu" aria-label="Menu principal">
        <ul>
          <li>
            <a href="/loja"><i class="bi bi-shop"></i> Loja</a>
          </li>
          <li>
            <a href="/tarefas"><i class="bi bi-check2-square"></i> Tarefas</a>
          </li>
          <li>
            <a href="/doacao"><i class="bi bi-heart"></i> Doação</a>
          </li>
          <li>
            <a href="/agendamento1"
              ><i class="bi bi-calendar-check"></i> Atendimento Online</a
            >
          </li>

          <% if (usuario && usuario.tipo === "farmacia") { %>
          <li>
            <a href="/adm/home2"
              ><i class="bi bi-shop-window"></i> Minha Loja</a
            >
          </li>
          <% } %> <% if (usuario && usuario.tipo === "profissional") { %>
          <li>
            <a href="/adm/home3"
              ><i class="bi bi-calendar-week"></i> Painel Profissional</a
            >
          </li>
          <% } %>

          <li>
            <a href="/#"><i class="bi bi-envelope"></i> Contato</a>
          </li>
          <li>
            <a href="/informacoes"><i class="bi bi-info-circle"></i> Dúvidas</a>
          </li>
        </ul>

        <label for="menuToggle" class="close-menu">&times;</label>
      </nav>
    </section>

    <!-- LOGO -->
    <a href="/tomarammeutela" class="header-logo">
      <img src="/imagem/1x/logozeko.png" alt="Healthy Safely" />
    </a>

    <!-- BARRA DE PESQUISA PRIMÁRIA (some quando tela for menor que 650px) -->
    <form class="search-bar" role="search">
      <label class="search-icon" for="headerSearch">
        <svg width="24" height="24" viewBox="0 0 36 36" fill="none">
          <circle cx="16" cy="16" r="12" stroke="#fff" stroke-width="3" />
          <line
            x1="26"
            y1="26"
            x2="32"
            y2="32"
            stroke="#fff"
            stroke-width="3"
            stroke-linecap="round"
          />
        </svg>
      </label>
      <input type="text" id="headerSearch" placeholder="Busque o que deseja" />
    </form>

    <!-- AÇÕES DO USUÁRIO -->
    <nav class="header-actions" aria-label="Ações do usuário">
      <!-- MENU CARRINHO LATERAL(fechado) -->
      <div class="user-menu">
        <a
          href="javascript:void(0);"
          class="action-btn"
          aria-label="Carrinho de compras"
          onclick="openCartMenu()"
        >
          <i class="bi bi-cart"></i>
        </a>
      </div>

      <!-- MENU CARRINHO LATERAL(ABERTO) -->
      <div id="cartSidebar" class="cart-sidebar">
        <div class="cart-header">
          <h2>Carrinho de Compras</h2>
          <button class="close-btn" onclick="closeCartMenu()">&times;</button>
        </div>

        <div class="cart-sidebar-content">
          <% if (usuario && usuario.tipo === "cliente" || usuario &&
          usuario.tipo === "farmacia" || usuario && usuario.tipo ===
          "profissional" ) { %>
          <ul id="cartItems"></ul>
          <% } else{%>
          <div class="cart-sem-login">
            <h1>
              É necessário fazer <a href="/login">login</a> para adicionar algum
              produto ao carrinho.
            </h1>
          </div>
          <%} %>
        </div>

        <div class="cart-footer">
          <div class="total">
            <span>Total:</span>
            <span id="cartTotal">R$ 0,00</span>
          </div>
          <button>Finalizar Compra</button>
        </div>
      </div>

      <!-- ÍCONE DE SININHO E MODAL DE NOTIFICAÇÕES -->
      <div class="user-menu">
        <i class="bi bi-bell" id="notificationMenuToggle"></i>
        <section
          id="notificationMenu"
          class="notification-dropdown hidden"
          role="menu"
        >
          <h3>Notificações</h3>
          <ul id="notificationList">
            <li>Nenhuma notificação nova.</li>
          </ul>
          <a href="#" role="menuitem">Ver todas as notificações</a>
        </section>
      </div>

      <!-- PERFIL -->
      <div class="user-menu">
        <i class="bi bi-person-circle" id="perfilMenuToggle"></i>
        <section id="perfilMenu" class="perfil-dropdown hidden" role="menu">
          <% if (usuario) { %>
          <li><a href="/perfil">Minha conta</a></li>
          <li><a href="/meus-pedidos">Meus pedidos</a></li>
          <li><a href="/meusfavoritos">Favoritos</a></li>
          <% if (usuario.tipo === "farmacia") { %>
          <li><a href="/adm/home2">Gerenciar loja</a></li>
          <li><a href="/adm/vendas">Minhas vendas</a></li>
          <% } else if (usuario.tipo === "profissional") { %>
          <li><a href="/adm/agenda">Minha agenda</a></li>
          <li><a href="/adm/consultas">Consultas</a></li>
          <% } %>

          <li><hr /></li>

          <li><a href="/logout" class="logout-btn">Sair</a></li>
          <% } else { %>
          <a href="/login" role="menuitem">Entrar</a>
          <button class="abrir-cadastro" role="menuitem">Cadastrar</button>
          <% } %>
        </section>
      </div>
      <!-- FIM PERFIL -->
    </nav>
    <!-- FIM AÇÕES DO USUÁRIO -->
  </section>
  <!-- FIM HEADER CONTAINER-->

  <!-- SUBMENU DE FUNCIONALIDADES (some a partir de 650px) -->
  <nav class="header-nav" id="mobileNav" aria-label="Navegação principal">
    <a href="/loja">Loja</a>

    <% if (usuario && usuario.tipo === "farmacia") { %>
    <a href="/adm/home2">Minha Loja</a>
    <% } %>
    <!---->
    <% if (usuario && usuario.tipo === "profissional") { %>
    <a href="/adm/home3">Painel Profissional</a>
    <% } %>

    <a href="/tarefas">Tarefas</a>
    <a href="/progressao">Progressão</a>
    <a href="/doacao">Doação</a>
    <a href="/agendamento1">Atendimento Online</a>
  </nav>
  <!-- FIM SUBMENU -->
</header>

<!-- BARRA DE PESQUISA SECUNDÁRIA (aparece quando tela for menor que 650px)-->
<main class="fundo">
  <section class="search-bar2" role="search">
    <label class="search-icon" for="mobileSearch">
      <svg width="24" height="24" viewBox="0 0 36 36" fill="none">
        <circle cx="16" cy="16" r="12" stroke="#fff" stroke-width="3" />
        <line
          x1="26"
          y1="26"
          x2="32"
          y2="32"
          stroke="#fff"
          stroke-width="3"
          stroke-linecap="round"
        />
      </svg>
    </label>
    <input type="text" id="mobileSearch" placeholder="Busque o que deseja" />
  </section>
</main>
<!-- FIM BARRA DE PESQUISA SECUNDÁRIA-->

<!-- MODAL DE CADASTRO -->
<section
  id="headerModalCadastro"
  class="modal hidden"
  role="dialog"
  aria-modal="true"
  aria-labelledby="modalCadastroTitle"
>
  <section class="modal-content">
    <button id="headerCloseCadastroModal" class="close-btn" aria-label="Fechar">
      &times;
    </button>
    <h2 id="modalCadastroTitle">Escolha o tipo de cadastro</h2>
    <section class="opcoes-cadastro">
      <a href="/cadastroCliente" class="btn-cadastro">Como cliente</a>
      <a href="/cadastroColaborador" class="btn-cadastro"
        >Como um Colaborador</a
      >
    </section>
  </section>
</section>

<!--SCRIPT DO MODAL CADASTRAR-->
<script src="/js/modal-header.js"></script>

<!--SCRIPT CARRINHO -->
<script src="/js/cart-product.js"></script>

<!-- SCRIPT PARA O MODAL DE NOTIFICAÇÕES -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const notificationMenuToggle = document.getElementById(
      "notificationMenuToggle"
    );
    const notificationMenu = document.getElementById("notificationMenu");

    notificationMenuToggle.addEventListener("click", function () {
      notificationMenu.classList.toggle("hidden");
    });

    // Fechar o modal se clicar fora dele
    document.addEventListener("click", function (event) {
      if (
        !notificationMenu.contains(event.target) &&
        !notificationMenuToggle.contains(event.target)
      ) {
        notificationMenu.classList.add("hidden");
      }
    });
  });
</script>
